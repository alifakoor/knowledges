لاگ خیلی چیز مهمیه
وقتی یه سرور لاگ داره، یعنی داره به ما میگه چشه، و ما فقط باید بهش گوش کنیم
لاگ و متریک چشم و گوش ما در سیستم است

**نکته مهم:** باید فرمت لاگ رو درست قرار بدهیم، چون در اون فرمت ما میتونیم مشخص کنیم که چه چیزهایی در لاگ قرار بگیره

همونقدری که لاگ کم بده و مشکل ایجاد میکنه، لاگ زیاد هم مشکل ایجاد میکنه
باید سعی کنیم همه چی بهینه باشه

معمولا تو لینوکس محل لاگ در `/var/log` هستش

معمولا در پروژه‌ها ما central management logging داریم که یه سرور لاگ داریم، و همه لاگ‌ها رو میفرستیم اونجا

#### common linux log files names and usage:

![[Pasted image 20240801080022.png]]


listing the linux kernel ring buffer messages:
we use the dmesg command to examine or control the kernel ring buffer. the default action is to display all messages from the kernel ring buffer. for example:
```
sudo dmesg
sudo dmesg | grep 'error'
sudo dmesg | grep -i -E 'error|warn|failed'
sudo dmesg | more
```


یکی از ابزارهایی که باهش میتونیم لاگ‌ها رو بفرستیم و دریافت بکنیم `rsyslogd` هستش
it is a system utility providing support for message logging.
you can view its config file by typing the following command:
```
vim /etc/rsyslogd.conf
ls /etc/rsyslog.d/
```


اینکه یه سرور دیگه داشته باشیم به عنوان central management logging از این نظر هم مهمه که اگر کسی به سرور ما حمله کرد، معمولا ردپای خودش هم از لاگ‌ها پاک میکنه، پس اینکه ما لاگ‌ها رو بفرستیم یه جای دیگه مهمه،‌چون اونجا میتونیم لاگ‌های اون شخص حمله کننده رو هم ببینیم

یکی دیگه از ابزارهایی که میشه باهش لاگ‌ها رو دید، [[journald]] است که دو اپشن مهم داره:
```
journalctl -f -u apache
```
`-f` => follow
`-u` => unit

the `-u` switch can be used multiple time:
```
journalctl -f -u apache.service -u php-cgi.service -u mysqld.service
```

show all collected logs are shown unfiltered as follows:
```
journalctl
```

view all boot messages:
```
journalctl -b
```

show kernel logs from previous boot:
```
journalctl -k -b -1
```

only display last 10 log entries:
```
journalctl -n 10 -u nginx.service
```

see all logs generated by the D-Bus or app executable:
```
journalctl /usr/bin/dbus-daemon
journalctl /usr/local/bin/app
```

reverse output so that the newest entries are displayed first:
```
journalctl -r
journalctl -r -u apache.service
```

show only linux kernel messages:
```
journalctl -k
journalctl --dmesg
```

we can filter output to entries where the MESSAGE=field matches the specified regular expression. PERL-compatible regular expressions are used. for instance:
```
journalctl -k -g PATTERN
journalctl -u mysqld.service -g PATTERN
journalctl -u nginx.service -g 'error'
journalctl -k -g failed
```
please note that if the pattern is all lowercase, matching is case insensitive. otherwise, matching is case sensitive. this can be overridden with the `--case-sensitive` option.