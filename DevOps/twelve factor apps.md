برای اینکه مهاجرت کنیم به کلاد باید ابتدا اپلیکیشن خودمون رو ارزیابی کنیم و بدونیم وضعیت فعلیش چطوری هست؟ بعد ۱۲ فاکتوری که در ادامه میاد رو بررسی کنیم

**۱. code base:** باید اپلیکیشن‌هامون رو روی کد ریپازیتوری نگهداری کنیم تا بتونیم به کلاد مهاجرت کنیم، یکی از اولین چیزهایی که هر سازمانی لازم دارد

**۲. dependency:** شما باید یک باندل از dependencyها و libraryهایی که اپ شما برای اجرا به آنها نیاز دارد را در کنار اون داشته باشید، قبل از کانتینرها این مشکل بزرگی بود.

**۳. configuration:** باید config شما به عنوان variable باشد،‌ نه به صورت هارد کد در کد وجود داشته باشند، در واقع نباید بخاطر تغییر config شما کد را تغییر بدهید، برای محیطهای مختلف مثل تست و پروداکشن باید configهای متفاوت داشته باشیم و برای هر کدام از آنها نباید اپ را دوباره بیلد کنیم

**۴. backing service:** اگر شما با یکسری سرویس کار می‌کنی مثل دیتابیس، queueها و ... حتما باید در کانکشنی که به آنها داری باید retry بزاری و کانکشن باید یک stringی باشد که راحت بشه تغییرش داد.

**۵. build, release, run:** این فرآیندها باید اتوماتیک باشد، یک سازمان باید ci/cd باید داشته باشیم، الان با حضور کانتینرها شما میتونید حتی از روز اول اپلیکیشنتون ci/cd براش داشته باشید

**۶. stateless بودن:** هر اپی که دارین توسعه میدین باید stateless باشد
اما stateless یعنی اینکه اپ شما به state قبل خودش وابسته نیست در حالی که stateful یعنی اینکه اپ شما به state قبل خودش وابسته هست
اگر هم stateی مثل session و ... دارین اون رو در ابزارهایی مثل redis, queue و ... داشته باشیم که راهکارهای کلاسترینگ دارند
دقت کنید که هر اپلیکیشن statefulی را باید به کلاسترینگش فکر کنیم و اگر ابزارهای استاندارد اون اپلیکیشن نباشند نیاز هست که راهکارهای کلاسترینگ براش به وجود بیاد، که اینکار کار سختی هستش

**۷. port binding:** باید پورت‌هایی که از اپ شما استفاده میکنه و دارن listen میشن باید مشخص باشند

**۸. concurrency:** اگر شما اپ خودتون رو stateless آورده باشین بالا، ما می‌تونیم تعداد بیشتری از اون رو ران کنیم، یعنی اینکه چندتا از اون رو همزمان کنار هم داشته باشیم و این باعث میشه که performance بالاتری داشته باشیم، کلا مبحث [[scalilng]] رو باید برای اپ خودتون در نظر بگیرد، [[scale up]] و [[scale out]]

**۹. disposability:** نحوه استارت شدن یک پروسه و نحوه خاموش شدن آن خیلی مهم است، مثلا یک پروسه وقتی سیگنال kill رو دریافت میکنه چطوری بمیره؟ اینکه در لحظه بمیره یا اینکه جواب همه کانکشن‌هایی که از قبل داره رو بده بعد بمیره؟ خب مطلوب این هست که جواب کانکشن‌های قبلی رو بده، به اینها میگیم sys kill
باید به فرآیندهای استارت شدن و خاموش شدن پروسه‌تون باید فکر کنید، می‌توان در داکر ست که مثلا یک پروسه بعد از دریافت سیگنال kill اول جواب کانکشن‌هایی که دارد را بدهد بعد بمیرد، رعایت کردن این موضوع باعث می‌شود که down time نداشته باشید و کیفیت سرویستون بالاتر برود

**۱۰. multiple environment:** خوبه که محیطهای مختلفی داشته باشید، برای تست، برای دولوپ، برای پروداکشن و ...
به اصطلاح dev/prod parity
خوبه که ۳تا محیط داشته باشیم: develoment, pre-production, production

**۱۱. log:** لاگ خیلی اهمیت دارد، لاگ به ما کمک میکنه مشکلات سیستم رو درک کنیم، مثلا وقتی شما میرین دکتر، به دکتر میگین که اینجام درد میکنه، حالم اینطوریه، این میشه که به دکتر میفهمونه ما چه مریضی داریم، لاگ هم همینطوریه
خوبه که حتما لاگ خوبی بسازید، یعنی به درستی لاگ بسازید و به اندازه باشه، نه کم باشه، نه زیاد باشه
در مورد metric هم همینطوره، سعی کنید metricهای مانیتورینگ خوبی درست بکنید که این metricها بهمون کمک میکنه ببینیم سیستممون الان حالش چطوره

**۱۲. admin process:** اگر شما دارین یک admin process ایجاد می‌کنید و استفاده می‌کنید، این فقط باید یکبار باشد، این نباید یه چیز جاری باشه، باید برای حالت خاصی یا برطرف کردن یک tshootی باشد، هرچند که tshoot را هم باید از طریق لاگ‌ها و metricها باید متوجه بشیم و رفع کنیم



بعضی نکات اضافه:

- حتما configهاتون به عنوان variable باشه، حتی اگر تعدادشون زیاد هستش
- حتما اپ‌هاتون stateless باشند، چون stateful بودن اپ مشکلات زیادی ایجاد می‌کند
- حتما برای connectionهای سرویس‌هاتون retry بزارین
- حتما connection stringی که دارین برای read و write جدا باشه، چون معمولا وقتی دیتابیس رو کلاستر می‌کنیم write معمولا در یک نقطه هستش اما read رو می‌تونیم به تعداد replicaها افزایش بدیم
- حتما برای connection database رمز و پسورد و authentication بزنید
- برای اپ‌هاتون حتما [[readiness]] و [[liveness]] بزارید، به اصطلاح مثلا prop (در کوبرنتیز) بزارید، این خیلی کمک میکنه به ما که تو بگی کی اپلیکیشنت زنده‌ست و کی آمده‌ای که ترافیک سمتش بره
- لاگ و log format خیلی اهمیت دارد، هرچقدر در مورد metric و log صحبت کنیم کمه، این دو تا هستند که به ما کمک میکنن که بفهمیم حال اپلیکیشنمون چطوره؟ فرمت لاگ خیلی مهمه، باید لاگ فرمت شفافی داشته باشیم که بقیه بتونن باهش ارتباط برقرار کنند
- حتما تست داشته باشید، اگر تست نداشته باشیم تو این اجازه رو به اپلیکیشنت دادی که تو پروداکشن failed داشته باشد، اگر تست نباشد، من نمیتونم جلوی failed تو پروداکشن رو بگیرم
- سعی کنید تمام فرآیند‌ها و اکشن‌هایی که انجام می‌دهید اتوماتیک باشد
- استاتیک ابجکت‌هاتون رو باید روی ابجکت استوریج ذخیره کنید نه در دیتابیس
- 